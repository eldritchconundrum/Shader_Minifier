/* File generated with Shader Minifier 1.1.6
 * http://www.ctrl-alt-test.fr
 */
#ifndef QUATERNION_FRAG_ACTUAL_
# define QUATERNION_FRAG_ACTUAL_
# define VAR_RESOLUTION "v"
# define VAR_TEX0 "f"
# define VAR_TEX1 "i"
# define VAR_TEX2 "d"
# define VAR_TEX3 "k"
# define VAR_TIME "w"

const char *quaternion_frag =
 "uniform vec2 v;"
 "uniform float w;"
 "uniform sampler2D f,i,d,k;"
 "float t(in vec3 v,in vec3 w,in vec4 d,out float f)"
 "{"
   "float i,x,r,k,y=1000.;"
   "vec4 s,u;"
   "f=0.;"
   "for(k=0.;k<6.;k+=r)"
     "{"
       "f+=1.;"
       "vec3 t=v+k*w;"
       "s=vec4(t,(d.y+d.x)*.3);"
       "x=1.;"
       "i=dot(s,s);"
       "for(int n=0;n<9;n++)"
         "{"
           "x*=4.*i;"
           "u.x=s.x*s.x-dot(s.yzw,s.yzw);"
           "u.yzw=2.*s.x*s.yzw;"
           "s=u+d;"
           "i=dot(s,s);"
           "if(i>4.)"
             "break;"
         "}"
       "r=.25*sqrt(i/x)*log(i);"
       "if(r<.0005)"
         "{"
           "y=k;"
           "break;"
         "}"
     "}"
   "return y;"
 "}"
 "vec3 t(in vec3 v,in vec4 w)"
 "{"
   "vec4 s,i,f[4],d=vec4(v,(w.y+w.x)*.3);"
   "f[0]=vec4(1.,0.,0.,0.);"
   "f[1]=vec4(0.,1.,0.,0.);"
   "f[2]=vec4(0.,0.,1.,0.);"
   "for(int n=0;n<9;n++)"
     "{"
       "vec4 x=vec4(d.x,-d.y,-d.z,-d.w);"
       "f[0]=vec4(dot(x,f[0]),d.x*f[0].yzw+f[0].x*d.yzw);"
       "f[1]=vec4(dot(x,f[1]),d.x*f[1].yzw+f[1].x*d.yzw);"
       "f[2]=vec4(dot(x,f[2]),d.x*f[2].yzw+f[2].x*d.yzw);"
       "s.x=dot(d,x);"
       "s.yzw=2.*d.x*d.yzw;"
       "d=s+w;"
       "if(dot(d,d)>4.)"
         "break;"
     "}"
   "return normalize(vec3(dot(d,f[0]),dot(d,f[1]),dot(d,f[2])));"
 "}"
 "void main()"
 "{"
   "vec2 d=-1.+2.*gl_FragCoord.xy/v.xy;"
   "vec3 f=vec3(0.);"
   "vec4 x=vec4(.7*cos(.5*w),.7*sin(.3*w),.7*cos(w),0.);"
   "vec3 s=normalize(vec3(d,1.)),i=vec3(0.,0.,-2.);"
   "float k,r=t(i,s,x,k);"
   "if(r<100.)"
     "{"
       "vec3 n=i+r*s,y=t(n,x);"
       "float c=.5+.5*dot(y,vec3(.57703));"
       "k=max(1.-k*.005,0.);"
       "f=vec3(1.,.9,.5)*c*k+.5*vec3(.6,.7,.8)*k;"
     "}"
   "else"
     " f=vec3(.5,.51,.52)+vec3(.5,.47,.45)*d.y;"
   "gl_FragColor=vec4(f,1.);"
 "}";

#endif // QUATERNION_FRAG_ACTUAL_
